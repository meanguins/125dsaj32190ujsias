<!DOCTYPE html>
<html lang="ro">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SpecificaÈ›ii Interactive & Ghid - Procesator Inteligent de CV-uri</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Chosen Palette: Calm Neutrals with Sky Blue Accent */
        /* Application Structure Plan: Single-page application with tab-based navigation (Prezentare GeneralÄƒ, FuncÈ›ionalitÄƒÈ›i, Schema de ExtracÈ›ie, Tehnologii, ConsideraÈ›ii, Configurare Sistem, Ghid Utilizare). Content displayed dynamically. Interactive schema viewer. Data flow diagram visualization. Designed for easy understanding of the backend system's technical specifications, setup, and usage. */
        /* Visualization & Content Choices: Overview: Text, HTML/CSS data flow diagram. Features: Clickable text sections. Data Schema: Interactive nested list for CV_EXTRACTION_SCHEMA. Tech Stack: List. Considerations: Expandable text. Setup & Usage: Detailed step-by-step text, code blocks for examples. No Chart.js/Plotly as report is spec, not data. Focus on HTML/CSS for visuals. NO SVG/Mermaid. */
        /* CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. */
        body {
            font-family: 'Inter', sans-serif; 
        }
        .tab-active {
            border-bottom-width: 2px;
            border-color: #0284c7; /* sky-600 */
            color: #0284c7; /* sky-600 */
            font-weight: 600;
        }
        .content-section {
            display: none;
        }
        .content-section.active {
            display: block;
        }
        .schema-key {
            cursor: pointer;
            font-weight: 500;
        }
        .schema-details {
            display: none;
            padding-left: 1.5rem; /* pl-6 */
            border-left: 2px solid #e5e7eb; /* gray-200 */
            margin-left: 0.5rem; /* ml-2 */
        }
        .schema-details.open {
            display: block;
        }
        .flow-step {
            min-height: 80px; 
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            display: flex;
            flex-direction: column;
            justify-content: center; 
        }
        .flow-step:hover {
            transform: translateY(-3px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }
        .flow-arrow {
            font-size: 1.5rem; /* text-2xl */
            line-height: 2rem; /* leading-8 */
            color: #38bdf8; /* sky-400 */
            display: flex;
            align-items: center;
            justify-content: center;
            min-height: 80px; 
        }
        .code-block {
            background-color: #1f2937; /* gray-800 */
            color: #f3f4f6; /* gray-100 */
            padding: 1rem;
            border-radius: 0.5rem; /* rounded-lg */
            overflow-x: auto;
            font-family: 'Courier New', Courier, monospace;
            font-size: 0.875rem; /* text-sm */
            line-height: 1.25rem;
            margin-top: 0.5rem;
            margin-bottom: 0.5rem;
        }
        .expand-button::after {
            content: ' â–¼';
            font-size: 0.75em;
            margin-left: 4px;
        }
        .expand-button.open::after {
            content: ' â–²';
        }
        .step-counter {
            background-color: #0284c7; /* sky-600 */
            color: white;
            border-radius: 50%;
            width: 2rem; /* w-8 */
            height: 2rem; /* h-8 */
            display: inline-flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            margin-right: 0.75rem; /* mr-3 */
        }
        h3.step-title {
            display: flex;
            align-items: center;
            font-size: 1.25rem; /* text-xl */
            font-weight: 600; /* font-semibold */
            color: #0369a1; /* sky-700 */
            margin-bottom: 0.75rem; /* mb-3 */
        }
         h4.sub-step-title {
            font-size: 1.125rem; /* text-lg */
            font-weight: 600; /* font-semibold */
            color: #075985; /* sky-800 */
            margin-top: 1rem; /* mt-4 */
            margin-bottom: 0.5rem; /* mb-2 */
        }
    </style>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
</head>
<body class="bg-slate-100 text-slate-800 antialiased">

    <header class="bg-sky-700 text-white shadow-lg sticky top-0 z-50">
        <div class="container mx-auto px-4 sm:px-6 lg:px-8 py-4">
            <h1 class="text-2xl sm:text-3xl font-bold text-center">SpecificaÈ›ii Interactive & Ghid - Procesator Inteligent de CV-uri</h1>
        </div>
    </header>

    <nav class="bg-white shadow-md sticky top-[68px] sm:top-[76px] z-40">
        <div class="container mx-auto px-4 sm:px-6 lg:px-8">
            <ul class="flex flex-wrap justify-center sm:justify-start space-x-2 sm:space-x-4 -mb-px">
                <li><button class="tab-button inline-block p-3 sm:p-4 text-sm sm:text-base text-slate-600 hover:text-sky-600" data-tab="overview">Prezentare GeneralÄƒ</button></li>
                <li><button class="tab-button inline-block p-3 sm:p-4 text-sm sm:text-base text-slate-600 hover:text-sky-600" data-tab="features">FuncÈ›ionalitÄƒÈ›i</button></li>
                <li><button class="tab-button inline-block p-3 sm:p-4 text-sm sm:text-base text-slate-600 hover:text-sky-600" data-tab="schema">Schema de ExtracÈ›ie</button></li>
                <li><button class="tab-button inline-block p-3 sm:p-4 text-sm sm:text-base text-slate-600 hover:text-sky-600" data-tab="tech">Tehnologii</button></li>
                <li><button class="tab-button inline-block p-3 sm:p-4 text-sm sm:text-base text-slate-600 hover:text-sky-600" data-tab="setup">Configurare Sistem</button></li>
                <li><button class="tab-button inline-block p-3 sm:p-4 text-sm sm:text-base text-slate-600 hover:text-sky-600" data-tab="usage">Ghid Utilizare</button></li>
                <li><button class="tab-button inline-block p-3 sm:p-4 text-sm sm:text-base text-slate-600 hover:text-sky-600" data-tab="considerations">ConsideraÈ›ii</button></li>
            </ul>
        </div>
    </nav>

    <main class="container mx-auto p-4 sm:p-6 lg:p-8 mt-4">
        <section id="overview" class="content-section bg-white p-6 rounded-lg shadow-lg">
            <h2 class="text-2xl font-semibold text-sky-700 mb-4">Prezentare GeneralÄƒ a Sistemului</h2>
            <p class="mb-4 text-slate-700 leading-relaxed">
                AceastÄƒ aplicaÈ›ie interactivÄƒ vÄƒ ghideazÄƒ prin specificaÈ›iile tehnice, configurarea È™i utilizarea sistemului nostru avansat de procesare automatÄƒ a CV-urilor. Sistemul este conceput ca o soluÈ›ie robustÄƒ È™i scalabilÄƒ, menitÄƒ sÄƒ eficientizeze extragerea informaÈ›iilor structurate din CV-uri, utilizÃ¢nd cele mai noi tehnologii de inteligenÈ›Äƒ artificialÄƒ.
            </p>
            <div class="mb-6">
                <h3 class="text-xl font-semibold text-sky-600 mb-3">Arhitectura Sistemului È™i Tehnologii Cheie</h3>
                <p class="mb-3 text-slate-700">Sistemul este construit ca o aplicaÈ›ie web FastAPI, containerizatÄƒ cu Docker È™i optimizatÄƒ pentru implementare pe platforme serverless precum Google Cloud Run.</p>
                <ul class="list-disc list-inside space-y-1 text-slate-700">
                    <li><strong class="text-slate-800">API Backend:</strong> Dezvoltat Ã®n Python folosind framework-ul FastAPI.</li>
                    <li><strong class="text-slate-800">InteligenÈ›Äƒ ArtificialÄƒ GenerativÄƒ:</strong> UtilizeazÄƒ modelul `gemini-2.5-flash-preview-05-20` de la Google, accesat prin SDK-ul `google-genai`.</li>
                    <li><strong class="text-slate-800">BazÄƒ de Date NoSQL:</strong> Google Cloud Firestore Ã®n modul Nativ.</li>
                    <li><strong class="text-slate-800">PlatformÄƒ de Rulare (RecomandatÄƒ):</strong> Google Cloud Run.</li>
                    <li><strong class="text-slate-800">Containerizare:</strong> Docker.</li>
                </ul>
            </div>

            <div>
                <h3 class="text-xl font-semibold text-sky-600 mb-4">Fluxul de Date (End-to-End)</h3>
                <p class="mb-4 text-slate-700">UrmÄƒtoarea diagramÄƒ ilustreazÄƒ paÈ™ii principali Ã®n procesarea unui CV, de la primirea acestuia pÃ¢nÄƒ la stocarea datelor extrase.</p>
                
                <div class="grid grid-cols-1 md:grid-cols-5 gap-4 items-stretch mb-4">
                    <div class="flow-step bg-sky-50 p-4 rounded-lg shadow text-center">
                        <span class="text-3xl mb-2">ğŸ“¥</span>
                        <h4 class="font-semibold text-sky-700">1. Primire Webhook</h4>
                        <p class="text-sm text-slate-600">Sistem extern trimite CV (text/URL) È™i metadate.</p>
                    </div>
                    <div class="flow-arrow hidden md:flex">â”</div>
                    <div class="flow-step bg-sky-50 p-4 rounded-lg shadow text-center">
                        <span class="text-3xl mb-2">ğŸ›¡ï¸</span>
                        <h4 class="font-semibold text-sky-700">2. Validare & IdempotenÈ›Äƒ</h4>
                        <p class="text-sm text-slate-600">Verificare secret webhook È™i evitare duplicate.</p>
                    </div>
                    <div class="flow-arrow hidden md:flex">â”</div>
                    <div class="flow-step bg-sky-50 p-4 rounded-lg shadow text-center">
                        <span class="text-3xl mb-2">âš™ï¸</span>
                        <h4 class="font-semibold text-sky-700">3. Procesare AsincronÄƒ</h4>
                        <p class="text-sm text-slate-600">RÄƒspuns HTTP 202; procesarea continuÄƒ Ã®n fundal.</p>
                    </div>
                </div>
                
                <div class="flex justify-center my-2 md:my-4"><span class="flow-arrow transform md:rotate-0 rotate-90">â¬‡ï¸</span></div>
                
                <div class="grid grid-cols-1 md:grid-cols-5 gap-4 items-stretch mb-4">
                    <div class="flow-step bg-teal-50 p-4 rounded-lg shadow text-center">
                        <span class="text-3xl mb-2">ğŸ“„</span>
                        <h4 class="font-semibold text-teal-700">4. DescÄƒrcare & Parsare (URL)</h4>
                        <p class="text-sm text-slate-600">DescÄƒrcare asincronÄƒ È™i extragere text din PDF/DOCX.</p>
                    </div>
                    <div class="flow-arrow hidden md:flex">â”</div>
                    <div class="flow-step bg-teal-50 p-4 rounded-lg shadow text-center">
                        <span class="text-3xl mb-2">ğŸ§ </span>
                        <h4 class="font-semibold text-teal-700">5. Extragere Date (Gemini)</h4>
                        <p class="text-sm text-slate-600">Modelul AI extrage informaÈ›ii structurate conform schemei.</p>
                    </div>
                    <div class="flow-arrow hidden md:flex">â”</div>
                    <div class="flow-step bg-teal-50 p-4 rounded-lg shadow text-center">
                        <span class="text-3xl mb-2">ğŸ’¾</span>
                        <h4 class="font-semibold text-teal-700">6. PersistenÈ›Äƒ (Firestore)</h4>
                        <p class="text-sm text-slate-600">Salvare date iniÈ›iale, status, È™i date extrase.</p>
                    </div>
                </div>

                <div class="flex justify-center my-2 md:my-4"><span class="flow-arrow transform md:rotate-0 rotate-90">â¬‡ï¸</span></div>
                
                <div class="flow-step bg-indigo-50 p-4 rounded-lg shadow text-center max-w-md mx-auto">
                    <span class="text-3xl mb-2">ğŸ“Š</span>
                    <h4 class="font-semibold text-indigo-700">7. Verificare Status (OpÈ›ional)</h4>
                    <p class="text-sm text-slate-600">Clientul poate interoga un endpoint pentru a vedea starea procesÄƒrii.</p>
                </div>
            </div>
        </section>

        <section id="features" class="content-section bg-white p-6 rounded-lg shadow-lg">
            <h2 class="text-2xl font-semibold text-sky-700 mb-4">FuncÈ›ionalitÄƒÈ›i Detaliate</h2>
            <p class="mb-6 text-slate-700 leading-relaxed">
                Sistemul nostru include o serie de funcÈ›ionalitÄƒÈ›i avansate pentru a asigura o procesare eficientÄƒ, sigurÄƒ È™i fiabilÄƒ a CV-urilor. Fiecare componentÄƒ a fost proiectatÄƒ cu atenÈ›ie la detalii pentru a oferi o experienÈ›Äƒ optimÄƒ. Click pe fiecare titlu pentru a expanda detaliile.
            </p>
            <div class="space-y-6">
                <div>
                    <h3 class="text-xl font-semibold text-sky-600 mb-2 expand-button cursor-pointer" onclick="toggleDetails(this, 'feature-webhook')">Endpoint Webhook (`/webhook/cv`)</h3>
                    <div id="feature-webhook" class="schema-details ml-0 pl-0 border-l-0">
                        <p class="text-slate-700 mb-1"><strong class="text-slate-800">MetodÄƒ HTTP:</strong> POST</p>
                        <p class="text-slate-700 mb-1"><strong class="text-slate-800">Securizare:</strong> Validare prin header `X-Webhook-Secret`.</p>
                        <p class="text-slate-700 mb-1"><strong class="text-slate-800">Payload Intrare:</strong> CV (text/URL), `source_candidate_id`, `idempotency_key`, `metadata`.</p>
                        <p class="text-slate-700 mb-1"><strong class="text-slate-800">RÄƒspuns:</strong> HTTP 202 Accepted, `processing_id`, `status`, `status_url`.</p>
                        <p class="text-slate-700">Comportament: ValideazÄƒ, verificÄƒ idempotenÈ›a, iniÈ›iazÄƒ procesare asincronÄƒ.</p>
                    </div>
                </div>
                <div>
                    <h3 class="text-xl font-semibold text-sky-600 mb-2 expand-button cursor-pointer" onclick="toggleDetails(this, 'feature-url-processing')">Procesarea FiÈ™ierelor CV de la URL</h3>
                     <div id="feature-url-processing" class="schema-details ml-0 pl-0 border-l-0">
                        <p class="text-slate-700 mb-1"><strong class="text-slate-800">Biblioteci:</strong> `aiohttp`, `PyPDF2`, `python-docx`.</p>
                        <p class="text-slate-700 mb-1">DescÄƒrcare asincronÄƒ, User-Agent generic, detecÈ›ie MIME.</p>
                        <p class="text-slate-700">Gestionare robustÄƒ a erorilor de reÈ›ea È™i parsare.</p>
                    </div>
                </div>
                 <div>
                    <h3 class="text-xl font-semibold text-sky-600 mb-2 expand-button cursor-pointer" onclick="toggleDetails(this, 'feature-gemini')">Integrarea cu API-ul Gemini</h3>
                     <div id="feature-gemini" class="schema-details ml-0 pl-0 border-l-0">
                        <p class="text-slate-700 mb-1"><strong class="text-slate-800">SDK:</strong> `google-genai`.</p>
                        <p class="text-slate-700 mb-1"><strong class="text-slate-800">Model:</strong> `gemini-2.5-flash-preview-05-20`.</p>
                        <p class="text-slate-700 mb-1"><strong class="text-slate-800">ConfiguraÈ›ie:</strong> `response_mime_type: "application/json"`, `response_schema`, `temperature: 0.1`, `safety_settings: BLOCK_NONE`, `thinking_config: thinking_budget=0`.</p>
                        <p class="text-slate-700 mb-1">Prompt Ã®n englezÄƒ, apel asincron, reÃ®ncercÄƒri automate.</p>
                    </div>
                </div>
                <div>
                    <h3 class="text-xl font-semibold text-sky-600 mb-2 expand-button cursor-pointer" onclick="toggleDetails(this, 'feature-firestore')">PersistenÈ›a Datelor Ã®n Firestore</h3>
                     <div id="feature-firestore" class="schema-details ml-0 pl-0 border-l-0">
                        <p class="text-slate-700 mb-1"><strong class="text-slate-800">SDK:</strong> `firebase-admin`.</p>
                        <p class="text-slate-700 mb-1"><strong class="text-slate-800">Structura ColecÈ›iei:</strong> `artifacts/{APP_ID}/users/cv_processing_service_user/processed_cvs`.</p>
                        <p class="text-slate-700 mb-1">StocheazÄƒ: `processing_id`, payload, status, date extrase, erori, timestamps, etc.</p>
                    </div>
                </div>
                 <div>
                    <h3 class="text-xl font-semibold text-sky-600 mb-2 expand-button cursor-pointer" onclick="toggleDetails(this, 'feature-status')">Endpoint de Status</h3>
                     <div id="feature-status" class="schema-details ml-0 pl-0 border-l-0">
                        <p class="text-slate-700 mb-1"><strong class="text-slate-800">MetodÄƒ HTTP:</strong> GET, `/status/cv/{processing_id}`.</p>
                        <p class="text-slate-700">ReturneazÄƒ starea curentÄƒ È™i rezultatele unei procesÄƒri.</p>
                    </div>
                </div>
                <div>
                    <h3 class="text-xl font-semibold text-sky-600 mb-2 expand-button cursor-pointer" onclick="toggleDetails(this, 'feature-idempotency')">Gestionarea IdempotenÈ›ei</h3>
                     <div id="feature-idempotency" class="schema-details ml-0 pl-0 border-l-0">
                        <p class="text-slate-700">Previne procesÄƒrile duplicate bazate pe `idempotency_key` sau `source_candidate_id`.</p>
                    </div>
                </div>
            </div>
        </section>

        <section id="schema" class="content-section bg-white p-6 rounded-lg shadow-lg">
            <h2 class="text-2xl font-semibold text-sky-700 mb-4">Schema de ExtracÈ›ie a Datelor (`CV_EXTRACTION_SCHEMA`)</h2>
            <p class="mb-6 text-slate-700 leading-relaxed">
                Aceasta este structura JSON detaliatÄƒ pe care modelul Gemini o utilizeazÄƒ pentru a extrage È™i organiza informaÈ›iile din CV-uri. PuteÈ›i da click pe fiecare cheie principalÄƒ pentru a vedea sub-proprietÄƒÈ›ile È™i descrierile acestora. CÃ¢mpurile marcate cu "(obligatoriu)" Ã®n descrierea schemei din codul sursÄƒ sunt esenÈ›iale pentru structura de bazÄƒ a datelor extrase.
            </p>
            <div id="cvSchemaContainer" class="space-y-3">
                </div>
        </section>

        <section id="tech" class="content-section bg-white p-6 rounded-lg shadow-lg">
            <h2 class="text-2xl font-semibold text-sky-700 mb-4">Tehnologii Utilizate</h2>
            <p class="mb-6 text-slate-700 leading-relaxed">
                Sistemul se bazeazÄƒ pe un set de tehnologii moderne È™i performante pentru a asigura eficienÈ›Äƒ È™i fiabilitate.
            </p>
            <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6">
                <div class="bg-slate-50 p-4 rounded-lg shadow hover:shadow-md transition-shadow">
                    <h3 class="text-lg font-semibold text-sky-700">Python & FastAPI</h3>
                    <p class="text-sm text-slate-600">Pentru dezvoltarea rapidÄƒ È™i performantÄƒ a API-ului backend.</p>
                </div>
                <div class="bg-slate-50 p-4 rounded-lg shadow hover:shadow-md transition-shadow">
                    <h3 class="text-lg font-semibold text-sky-700">Google Gemini 2.5 Flash</h3>
                    <p class="text-sm text-slate-600">Model AI de ultimÄƒ generaÈ›ie pentru extragerea inteligentÄƒ a datelor (via SDK `google-genai`).</p>
                </div>
                <div class="bg-slate-50 p-4 rounded-lg shadow hover:shadow-md transition-shadow">
                    <h3 class="text-lg font-semibold text-sky-700">Google Cloud Firestore</h3>
                    <p class="text-sm text-slate-600">BazÄƒ de date NoSQL scalabilÄƒ pentru stocarea datelor.</p>
                </div>
                <div class="bg-slate-50 p-4 rounded-lg shadow hover:shadow-md transition-shadow">
                    <h3 class="text-lg font-semibold text-sky-700">Google Cloud Run</h3>
                    <p class="text-sm text-slate-600">PlatformÄƒ serverless pentru implementare È™i scalare automatÄƒ.</p>
                </div>
                <div class="bg-slate-50 p-4 rounded-lg shadow hover:shadow-md transition-shadow">
                    <h3 class="text-lg font-semibold text-sky-700">Docker</h3>
                    <p class="text-sm text-slate-600">Pentru containerizarea aplicaÈ›iei, asigurÃ¢nd portabilitate.</p>
                </div>
                <div class="bg-slate-50 p-4 rounded-lg shadow hover:shadow-md transition-shadow">
                    <h3 class="text-lg font-semibold text-sky-700">aiohttp, PyPDF2, python-docx</h3>
                    <p class="text-sm text-slate-600">Pentru procesarea asincronÄƒ a fiÈ™ierelor È™i extragerea textului.</p>
                </div>
                 <div class="bg-slate-50 p-4 rounded-lg shadow hover:shadow-md transition-shadow">
                    <h3 class="text-lg font-semibold text-sky-700">Pydantic</h3>
                    <p class="text-sm text-slate-600">Pentru validarea datelor È™i definirea modelelor.</p>
                </div>
                 <div class="bg-slate-50 p-4 rounded-lg shadow hover:shadow-md transition-shadow">
                    <h3 class="text-lg font-semibold text-sky-700">Tenacity</h3>
                    <p class="text-sm text-slate-600">Pentru implementarea logicii de reÃ®ncercare robustÄƒ.</p>
                </div>
            </div>
        </section>

        <section id="setup" class="content-section bg-white p-6 rounded-lg shadow-lg">
            <h2 class="text-2xl font-semibold text-sky-700 mb-6">Ghid de Configurare a Sistemului (Setup)</h2>
            <p class="mb-6 text-slate-700 leading-relaxed">
                UrmaÈ›i aceÈ™ti paÈ™i pentru a configura È™i rula local sistemul de procesare a CV-urilor. Acest ghid presupune cÄƒ aveÈ›i deja cunoÈ™tinÈ›e de bazÄƒ despre Python, terminal È™i Google Cloud Platform.
            </p>

            <div>
                <h3 class="step-title"><span class="step-counter">1</span>CerinÈ›e Preliminare</h3>
                <ul class="list-disc list-inside space-y-2 text-slate-700 mb-6 ml-10">
                    <li>**Python 3.10+** instalat pe sistemul dumneavoastrÄƒ.</li>
                    <li>**Pip** (managerul de pachete Python) actualizat.</li>
                    <li>**(OpÈ›ional, dar recomandat pentru implementare) Docker** instalat.</li>
                    <li>Un **cont Google Cloud Platform (GCP)** activ, cu facturarea configuratÄƒ.</li>
                    <li>**(Recomandat) Google Cloud SDK (`gcloud` CLI)** instalat È™i configurat pe maÈ™ina localÄƒ.</li>
                </ul>
            </div>

            <div>
                <h3 class="step-title"><span class="step-counter">2</span>ObÈ›inerea Codului SursÄƒ</h3>
                <p class="text-slate-700 mb-2 ml-10">DescÄƒrcaÈ›i sau clonaÈ›i fiÈ™ierele proiectului (`main.py`, `requirements.txt`, `Dockerfile`, etc.) Ã®ntr-un director local.</p>
            </div>

            <div>
                <h3 class="step-title"><span class="step-counter">3</span>Mediu Virtual È™i DependenÈ›e</h3>
                <p class="text-slate-700 mb-2 ml-10">Este recomandat sÄƒ folosiÈ›i un mediu virtual Python pentru a izola dependenÈ›ele proiectului.</p>
                <h4 class="sub-step-title ml-10">3.1. CreaÈ›i È™i ActivaÈ›i Mediul Virtual:</h4>
                <p class="text-slate-700 mb-2 ml-10">NavigaÈ›i Ã®n directorul proiectului È™i rulaÈ›i:</p>
                <div class="code-block ml-10">
                    <span class="block">python -m venv venv</span>
                    <span class="block"># Pe Windows:</span>
                    <span class="block">venv\Scripts\activate</span>
                    <span class="block"># Pe macOS/Linux:</span>
                    <span class="block">source venv/bin/activate</span>
                </div>
                <h4 class="sub-step-title ml-10">3.2. InstalaÈ›i DependenÈ›ele:</h4>
                <p class="text-slate-700 mb-2 ml-10">Cu mediul virtual activat, instalaÈ›i pachetele necesare:</p>
                <div class="code-block ml-10">pip install -r requirements.txt</div>
            </div>

            <div>
                <h3 class="step-title"><span class="step-counter">4</span>Configurarea Proiectului Google Cloud</h3>
                 <h4 class="sub-step-title ml-10">4.1. CreaÈ›i sau SelectaÈ›i un Proiect GCP:</h4>
                 <p class="text-slate-700 mb-2 ml-10">AccesaÈ›i <a href="https://console.cloud.google.com/" target="_blank" class="text-sky-600 hover:underline">Google Cloud Console</a> È™i selectaÈ›i un proiect existent sau creaÈ›i unul nou. NotaÈ›i **ID-ul Proiectului (Project ID)**.</p>
                 <h4 class="sub-step-title ml-10">4.2. ActivaÈ›i API-urile Necesare:</h4>
                 <p class="text-slate-700 mb-2 ml-10">Pentru proiectul selectat, asiguraÈ›i-vÄƒ cÄƒ urmÄƒtoarele API-uri sunt activate:</p>
                 <ul class="list-disc list-inside space-y-1 text-slate-700 mb-4 ml-14">
                    <li>**Cloud Firestore API:** Pentru baza de date.</li>
                    <li>**Vertex AI API:** Pentru accesul la modelele Gemini. (Nota: Gemini API poate fi listat È™i sub "Generative Language API" sau similar, Ã®n funcÈ›ie de interfaÈ›a consolei).</li>
                 </ul>
                 <p class="text-slate-700 mb-2 ml-10">PuteÈ›i activa API-urile din secÈ›iunea "APIs & Services" > "Library" a consolei GCP.</p>
            </div>

            <div>
                <h3 class="step-title"><span class="step-counter">5</span>Configurarea Firestore</h3>
                <p class="text-slate-700 mb-2 ml-10">DacÄƒ nu aÈ›i fÄƒcut-o deja la activarea API-ului:</p>
                <ul class="list-disc list-inside space-y-1 text-slate-700 mb-4 ml-14">
                    <li>NavigaÈ›i la secÈ›iunea Firestore din consola GCP.</li>
                    <li>CreaÈ›i o bazÄƒ de date Ã®n **Mod Nativ (Native Mode)**.</li>
                    <li>AlegeÈ›i o **locaÈ›ie** pentru baza de date (ex: `europe-west1` sau `eur5`). AceastÄƒ alegere este permanentÄƒ.</li>
                </ul>
            </div>
            
            <div>
                <h3 class="step-title"><span class="step-counter">6</span>Cont de Serviciu È™i Cheie JSON (pentru Dezvoltare LocalÄƒ)</h3>
                <p class="text-slate-700 mb-2 ml-10">Pentru ca aplicaÈ›ia sÄƒ se autentifice la GCP de pe maÈ™ina localÄƒ, veÈ›i avea nevoie de o cheie de cont de serviciu.</p>
                 <ul class="list-disc list-inside space-y-1 text-slate-700 mb-4 ml-14">
                    <li>Ãn consola GCP, navigaÈ›i la "IAM & Admin" > "Service Accounts".</li>
                    <li>Click pe "+ CREATE SERVICE ACCOUNT".</li>
                    <li>DaÈ›i un nume contului (ex: `cv-processor-dev-sa`).</li>
                    <li>AcordaÈ›i urmÄƒtoarele roluri contului de serviciu:
                        <ul class="list-circle list-inside ml-6">
                            <li>`Cloud Datastore User` (oferÄƒ acces la Firestore Ã®n Mod Nativ)</li>
                            <li>`Vertex AI User` (oferÄƒ acces la modelele Gemini È™i alte resurse Vertex AI)</li>
                        </ul>
                    </li>
                    <li>FinalizaÈ›i crearea contului de serviciu.</li>
                    <li>SelectaÈ›i contul nou creat, mergeÈ›i la tab-ul "KEYS", click pe "ADD KEY" > "Create new key".</li>
                    <li>AlegeÈ›i tipul **JSON** È™i click pe "CREATE". Un fiÈ™ier JSON va fi descÄƒrcat.</li>
                    <li>PÄƒstraÈ›i acest fiÈ™ier JSON Ã®ntr-un loc sigur.</li>
                </ul>
                <p class="text-slate-700 mb-2 ml-10">**AlternativÄƒ (ADC):** DacÄƒ aveÈ›i `gcloud` CLI instalat, rulaÈ›i `gcloud auth application-default login` È™i autentificaÈ›i-vÄƒ. Acest lucru configureazÄƒ Application Default Credentials (ADC), iar aplicaÈ›ia le poate folosi automat dacÄƒ variabila `GOOGLE_APPLICATION_CREDENTIALS` nu este setatÄƒ.</p>
            </div>

            <div>
                <h3 class="step-title"><span class="step-counter">7</span>Cheia API Gemini</h3>
                <p class="text-slate-700 mb-2 ml-10">ObÈ›ineÈ›i o cheie API pentru a utiliza modelele Gemini.</p>
                 <ul class="list-disc list-inside space-y-1 text-slate-700 mb-4 ml-14">
                    <li>MergeÈ›i la <a href="https://aistudio.google.com/app/apikey" target="_blank" class="text-sky-600 hover:underline">Google AI Studio</a>.</li>
                    <li>ConectaÈ›i-vÄƒ cu contul Google È™i creaÈ›i o nouÄƒ cheie API dacÄƒ nu aveÈ›i deja una pentru proiectul GCP selectat.</li>
                 </ul>
            </div>

            <div>
                <h3 class="step-title"><span class="step-counter">8</span>Configurarea Variabilelor de Mediu (`.env`)</h3>
                <p class="text-slate-700 mb-2 ml-10">CreaÈ›i un fiÈ™ier numit `.env` Ã®n directorul rÄƒdÄƒcinÄƒ al proiectului (lÃ¢ngÄƒ `main.py`) È™i adÄƒugaÈ›i urmÄƒtoarele variabile, Ã®nlocuind valorile placeholder:</p>
                <div class="code-block ml-10">
                    <span class="block">GEMINI_API_KEY="CHEIA_DVS_API_GEMINI_AICI"</span>
                    <span class="block">WEBHOOK_SECRET="UN_SECRET_PUTERNIC_PENTRU_WEBHOOK"</span>
                    <span class="block">GCP_PROJECT_ID="ID_UL_PROIECTULUI_DVS_GCP"</span>
                    <span class="block"># DecomentaÈ›i È™i completaÈ›i linia de mai jos DOAR dacÄƒ NU folosiÈ›i ADC</span>
                    <span class="block"># GOOGLE_APPLICATION_CREDENTIALS="/calea/completa/catre/fisierul_serviciu_cont.json"</span>
                </div>
                 <p class="text-slate-700 mt-2 ml-10">**NotÄƒ:** SDK-ul `google-genai` va cÄƒuta implicit variabila de mediu `GOOGLE_API_KEY`. Scriptul `main.py` este configurat sÄƒ foloseascÄƒ valoarea din `GEMINI_API_KEY` pentru `GOOGLE_API_KEY` dacÄƒ aceasta din urmÄƒ nu este setatÄƒ direct.</p>
            </div>
            
            <div>
                <h3 class="step-title"><span class="step-counter">9</span>Pornirea LocalÄƒ a Serverului</h3>
                <p class="text-slate-700 mb-2 ml-10">Cu mediul virtual activat È™i fiÈ™ierul `.env` configurat, porniÈ›i serverul FastAPI:</p>
                <div class="code-block ml-10">python main.py</div>
                <p class="text-slate-700 mt-2 ml-10">Serverul ar trebui sÄƒ ruleze pe `http://localhost:8000`. VerificaÈ›i logurile din terminal pentru a confirma iniÈ›ializarea corectÄƒ a serviciilor (Firestore, Gemini).</p>
            </div>
        </section>

        <section id="usage" class="content-section bg-white p-6 rounded-lg shadow-lg">
            <h2 class="text-2xl font-semibold text-sky-700 mb-6">Ghid de Utilizare a Sistemului</h2>
            <p class="mb-6 text-slate-700 leading-relaxed">
                OdatÄƒ ce sistemul backend este configurat È™i ruleazÄƒ, puteÈ›i interacÈ›iona cu el prin API-ul expus.
            </p>

            <div>
                <h3 class="step-title"><span class="step-counter">1</span>Endpoint Webhook: Procesare CV (`POST /webhook/cv`)</h3>
                <p class="text-slate-700 mb-2 ml-10">Acesta este endpoint-ul principal pentru a trimite CV-uri spre procesare.</p>
                
                <h4 class="sub-step-title ml-10">Securitate:</h4>
                <p class="text-slate-700 mb-2 ml-14">Toate cererile cÄƒtre acest endpoint trebuie sÄƒ includÄƒ header-ul HTTP `X-Webhook-Secret` cu valoarea secretului configuratÄƒ Ã®n fiÈ™ierul `.env`.</p>

                <h4 class="sub-step-title ml-10">Payload-ul Cererii (Request Body - JSON):</h4>
                <p class="text-slate-700 mb-2 ml-14">Corpul cererii trebuie sÄƒ fie un obiect JSON cu urmÄƒtoarea structurÄƒ (bazatÄƒ pe modelul Pydantic `WebhookPayload`):</p>
                <div class="code-block ml-14">
{
  "cv_text": "OpÈ›ional: Textul integral al CV-ului...",
  "cv_file_payload": {
    "cv_url": "OpÈ›ional: URL cÄƒtre fiÈ™ierul CV (ex: PDF, DOCX)",
    "file_mime_type": "OpÈ›ional: Tipul MIME al fiÈ™ierului din URL"
  },
  "source_candidate_id": "OpÈ›ional: ID-ul candidatului din sistemul sursÄƒ",
  "idempotency_key": "OpÈ›ional: Cheie unicÄƒ pentru idempotenÈ›Äƒ",
  "metadata": {
    "cheie_custom": "valoare_custom" 
  }
}
                </div>
                <p class="text-slate-700 mt-2 ml-14">**NotÄƒ:** Trebuie furnizat fie `cv_text`, fie `cv_file_payload.cv_url`.</p>

                <h4 class="sub-step-title ml-10">Exemple de Cereri `curl`:</h4>
                <p class="text-slate-700 mb-2 ml-14">ÃnlocuiÈ›i `YOUR_WEBHOOK_SECRET` cu valoarea realÄƒ.</p>
                <p class="text-slate-700 font-semibold mt-2 ml-14">a) Trimitere CV ca text:</p>
                <div class="code-block ml-14">
curl -X POST "http://localhost:8000/webhook/cv" \
-H "Content-Type: application/json" \
-H "X-Webhook-Secret: YOUR_WEBHOOK_SECRET" \
-d '{
  "cv_text": "Nume: Ion Popescu...",
  "source_candidate_id": "text-cand-001",
  "idempotency_key": "req-text-001"
}'
                </div>
                <p class="text-slate-700 font-semibold mt-2 ml-14">b) Trimitere CV ca URL:</p>
                <div class="code-block ml-14">
curl -X POST "http://localhost:8000/webhook/cv" \
-H "Content-Type: application/json" \
-H "X-Webhook-Secret: YOUR_WEBHOOK_SECRET" \
-d '{
  "cv_file_payload": {
    "cv_url": "https://example.com/cale/catre/cv.pdf",
    "file_mime_type": "application/pdf"
  },
  "source_candidate_id": "url-cand-002"
}'
                </div>
                <p class="text-slate-700 mt-2 ml-14">(Pentru CMD Windows, comanda `curl` trebuie sÄƒ fie pe o singurÄƒ linie, cu ghilimelele interne escapate: `-d "{...}"` devine `-d \"{...}\"`).</p>

                <h4 class="sub-step-title ml-10">RÄƒspuns AÈ™teptat (HTTP 202 Accepted):</h4>
                <div class="code-block ml-14">
{
  "message": "CV primit È™i procesarea a fost iniÈ›iatÄƒ Ã®n fundal.",
  "processing_id": "uuid-generat-automat",
  "status": "pending",
  "status_url": "http://localhost:8000/status/cv/uuid-generat-automat"
}
                </div>
                 <p class="text-slate-700 mt-2 ml-14">DacÄƒ se detecteazÄƒ o cerere duplicat (prin `idempotency_key` sau `source_candidate_id`), rÄƒspunsul va indica acest lucru, iar statusul va fi `already_received_or_processing`.</p>
            </div>

            <div>
                <h3 class="step-title mt-8"><span class="step-counter">2</span>Endpoint de Verificare a Statusului (`GET /status/cv/{processing_id}`)</h3>
                <p class="text-slate-700 mb-2 ml-10">FolosiÈ›i `processing_id`-ul returnat de endpoint-ul webhook pentru a interoga starea procesÄƒrii.</p>
                
                <h4 class="sub-step-title ml-10">Exemplu de Cerere `curl`:</h4>
                <p class="text-slate-700 mb-2 ml-14">ÃnlocuiÈ›i `ID_PROCESARE_PRIMIT` cu valoarea realÄƒ.</p>
                <div class="code-block ml-14">curl -X GET "http://localhost:8000/status/cv/ID_PROCESARE_PRIMIT"</div>

                <h4 class="sub-step-title ml-10">RÄƒspuns AÈ™teptat (HTTP 200 OK):</h4>
                <p class="text-slate-700 mb-2 ml-14">Structura rÄƒspunsului depinde de starea procesÄƒrii:</p>
                <p class="text-slate-700 font-semibold mt-2 ml-14">a) Procesare finalizatÄƒ cu succes:</p>
                <div class="code-block ml-14">
{
  "processing_id": "ID_PROCESARE_PRIMIT",
  "status": "completed",
  "received_at_utc": "timestamp...",
  "updated_at_utc": "timestamp...",
  "extracted_data": { /* Datele extrase conform CV_EXTRACTION_SCHEMA */ },
  "error_message": null,
  "processing_time_seconds": 15.7
}
                </div>
                <p class="text-slate-700 font-semibold mt-2 ml-14">b) Procesare Ã®n curs:</p>
                <div class="code-block ml-14">
{
  "processing_id": "ID_PROCESARE_PRIMIT",
  "status": "pending_processing", // sau "downloading_parsing", etc.
  "received_at_utc": "timestamp...",
  "updated_at_utc": "timestamp...",
  "extracted_data": null,
  "error_message": null,
  "processing_time_seconds": null
}
                </div>
                 <p class="text-slate-700 font-semibold mt-2 ml-14">c) Eroare Ã®n timpul procesÄƒrii:</p>
                <div class="code-block ml-14">
{
  "processing_id": "ID_PROCESARE_PRIMIT",
  "status": "error",
  "received_at_utc": "timestamp...",
  "updated_at_utc": "timestamp...",
  "extracted_data": null,
  "error_message": "Descrierea erorii...",
  "processing_time_seconds": 5.2
}
                </div>
                <p class="text-slate-700 mt-2 ml-14">DacÄƒ `processing_id` nu este gÄƒsit, se va returna un rÄƒspuns HTTP 404 Not Found.</p>
            </div>
            
            <div>
                <h3 class="step-title mt-8"><span class="step-counter">3</span>Interpretarea Datelor Extrase (`extracted_data`)</h3>
                <p class="text-slate-700 mb-2 ml-10">CÃ¢mpul `extracted_data` din rÄƒspunsul de status (cÃ¢nd procesarea este `completed`) va conÈ›ine un obiect JSON structurat conform `CV_EXTRACTION_SCHEMA`. PuteÈ›i explora detaliile acestei scheme Ã®n tab-ul "Schema de ExtracÈ›ie" din aceastÄƒ aplicaÈ›ie.</p>
            </div>

            <div>
                <h3 class="step-title mt-8"><span class="step-counter">4</span>IdempotenÈ›a</h3>
                <p class="text-slate-700 mb-2 ml-10">Pentru a preveni procesarea accidentalÄƒ a aceluiaÈ™i CV de mai multe ori (È™i costurile asociate), sistemul suportÄƒ idempotenÈ›a:</p>
                <ul class="list-disc list-inside space-y-1 text-slate-700 mb-4 ml-14">
                    <li>FurnizaÈ›i un `idempotency_key` unic Ã®n payload-ul webhook-ului. DacÄƒ o cerere cu aceeaÈ™i cheie este primitÄƒ din nou, sistemul va returna detaliile procesÄƒrii iniÈ›iale fÄƒrÄƒ a re-procesa CV-ul.</li>
                    <li>Ca alternativÄƒ, dacÄƒ `idempotency_key` nu este furnizat, dar `source_candidate_id` este, sistemul va folosi `source_candidate_id` pentru verificarea idempotenÈ›ei.</li>
                </ul>
            </div>
        </section>

        <section id="considerations" class="content-section bg-white p-6 rounded-lg shadow-lg">
            <h2 class="text-2xl font-semibold text-sky-700 mb-4">ConsideraÈ›ii Tehnice Suplimentare</h2>
            <p class="mb-6 text-slate-700 leading-relaxed">
                Pentru o implementare robustÄƒ Ã®n producÈ›ie, sunt luate Ã®n considerare urmÄƒtoarele aspecte:
            </p>
             <div class="space-y-4">
                <div>
                    <h4 class="text-lg font-semibold text-sky-600">Securitate</h4>
                    <ul class="list-disc list-inside text-slate-700 ml-4">
                        <li>Utilizarea variabilelor de mediu È™i a Google Secret Manager pentru secrete.</li>
                        <li>Validarea riguroasÄƒ a input-urilor.</li>
                    </ul>
                </div>
                <div>
                    <h4 class="text-lg font-semibold text-sky-600">Scalabilitate</h4>
                    <ul class="list-disc list-inside text-slate-700 ml-4">
                        <li>ArhitecturÄƒ serverless (Cloud Run) pentru scalare automatÄƒ.</li>
                        <li>Procesare asincronÄƒ pentru gestionarea eficientÄƒ a cererilor.</li>
                    </ul>
                </div>
                <div>
                    <h4 class="text-lg font-semibold text-sky-600">RobusteÈ›e</h4>
                    <ul class="list-disc list-inside text-slate-700 ml-4">
                        <li>Mecanisme de reÃ®ncercare pentru apelurile API externe.</li>
                        <li>Gestionarea explicitÄƒ a excepÈ›iilor.</li>
                    </ul>
                </div>
                <div>
                    <h4 class="text-lg font-semibold text-sky-600">Logging È™i Monitorizare</h4>
                    <ul class="list-disc list-inside text-slate-700 ml-4">
                        <li>Logging structurat pentru analizÄƒ Ã®n Cloud Logging.</li>
                        <li>Monitorizarea performanÈ›ei È™i a erorilor.</li>
                    </ul>
                </div>
            </div>
        </section>
    </main>

    <footer class="bg-slate-800 text-slate-300 text-center p-6 mt-12">
        <p>&copy; <span id="currentYear"></span> Sistem de Procesare a CV-urilor. Toate drepturile rezervate.</p>
    </footer>

    <script>
        const CV_EXTRACTION_SCHEMA = {
            "personal_info": {
                "type": "object",
                "description": "InformaÈ›ii de contact È™i identificare ale candidatului.",
                "properties": {
                    "full_name": {"type": "string", "description": "Numele complet al candidatului, aÈ™a cum apare Ã®n CV."},
                    "email": {"type": "string", "description": "Adresa de email principalÄƒ, validatÄƒ dacÄƒ posibil."},
                    "phone_number": {"type": "string", "description": "NumÄƒrul de telefon principal, format internaÈ›ional preferat dacÄƒ e clar."},
                    "linkedin_url": {"type": "string", "description": "URL cÄƒtre profilul LinkedIn, dacÄƒ este menÈ›ionat explicit."},
                    "github_url": {"type": "string", "description": "URL cÄƒtre profilul GitHub, dacÄƒ este menÈ›ionat."},
                    "portfolio_url": {"type": "string", "description": "URL cÄƒtre portofoliul personal, dacÄƒ este menÈ›ionat."},
                    "location": {"type": "string", "description": "OraÈ™ul È™i/sau È›ara de rezidenÈ›Äƒ, dacÄƒ sunt menÈ›ionate."}
                },
                "required": ["full_name"]
            },
            "summary_objective": {
                "type": "string",
                "description": "Sumarul profesional concis, obiectivul de carierÄƒ sau secÈ›iunea 'Despre mine' din CV."
            },
            "work_experience": {
                "type": "array",
                "description": "Lista experienÈ›elor profesionale anterioare.",
                "items": {
                    "type": "object",
                    "properties": {
                        "job_title": {"type": "string", "description": "Titlul exact al postului."},
                        "company_name": {"type": "string", "description": "Numele companiei angajatoare."},
                        "company_location": {"type": "string", "description": "LocaÈ›ia companiei (oraÈ™, È›arÄƒ), dacÄƒ este specificatÄƒ."},
                        "start_date": {"type": "string", "description": "Data de Ã®nceput a angajÄƒrii (ex: 'YYYY-MM', 'Luna Anul')."},
                        "end_date": {"type": "string", "description": "Data de sfÃ¢rÈ™it (ex: 'YYYY-MM', 'Luna Anul', 'Prezent')."},
                        "duration_months": {"type": "integer", "description": "Durata angajÄƒrii Ã®n luni, dacÄƒ poate fi calculatÄƒ."},
                        "responsibilities_achievements": {
                            "type": "array",
                            "items": {"type": "string"},
                            "description": "ListÄƒ detaliatÄƒ a responsabilitÄƒÈ›ilor, proiectelor È™i realizÄƒrilor cheie."
                        },
                        "technologies_used": {
                            "type": "array",
                            "items": {"type": "string"},
                            "description": "Tehnologii, unelte sau limbaje de programare specifice utilizate Ã®n acest rol."
                        }
                    },
                    "required": ["job_title", "company_name", "start_date"]
                }
            },
            "education": {
                "type": "array",
                "description": "Detalii despre parcursul educaÈ›ional.",
                "items": {
                    "type": "object",
                    "properties": {
                        "degree_name": {"type": "string", "description": "Numele diplomei sau calificÄƒrii obÈ›inute (ex: LicenÈ›Äƒ, Master, Doctorat)."},
                        "major_field_of_study": {"type": "string", "description": "Specializarea sau domeniul principal de studiu."},
                        "institution_name": {"type": "string", "description": "Numele instituÈ›iei de Ã®nvÄƒÈ›ÄƒmÃ¢nt."},
                        "institution_location": {"type": "string", "description": "LocaÈ›ia instituÈ›iei (oraÈ™, È›arÄƒ), dacÄƒ este specificatÄƒ."},
                        "graduation_date": {"type": "string", "description": "Data absolvirii sau data estimatÄƒ a absolvirii (ex: 'YYYY-MM', 'Anul')."},
                        "relevant_courses_thesis": {"type": "string", "description": "Cursuri relevante, proiecte academice sau titlul tezei, dacÄƒ sunt menÈ›ionate."}
                    },
                    "required": ["institution_name", "degree_name"]
                }
            },
            "skills": {
                "type": "object",
                "description": "Setul de competenÈ›e ale candidatului.",
                "properties": {
                    "technical_skills": {
                        "type": "array",
                        "items": {"type": "string"},
                        "description": "ListÄƒ de competenÈ›e tehnice (ex: limbaje de programare, framework-uri, baze de date, unelte)."
                    },
                    "soft_skills": {
                        "type": "array",
                        "items": {"type": "string"},
                        "description": "ListÄƒ de competenÈ›e interpersonale (ex: comunicare, leadership, lucru Ã®n echipÄƒ)."
                    },
                    "languages": {
                        "type": "array",
                        "items": {
                            "type": "object",
                            "properties": {
                                "language_name": {"type": "string"},
                                "proficiency_level": {"type": "string", "description": "Nivel de cunoaÈ™tere (ex: Nativ, Avansat, Mediu, ÃncepÄƒtor)."}
                            },
                             "required": ["language_name", "proficiency_level"]
                        },
                        "description": "Limbi strÄƒine cunoscute È™i nivelul de competenÈ›Äƒ."
                    }
                }
            },
            "certifications_awards": {
                "type": "array",
                "description": "CertificÄƒri, cursuri sau premii obÈ›inute.",
                "items": {
                    "type": "object",
                    "properties": {
                        "name": {"type": "string", "description": "Numele certificÄƒrii, cursului sau premiului."},
                        "issuing_organization": {"type": "string", "description": "OrganizaÈ›ia emitentÄƒ."},
                        "date_obtained": {"type": "string", "description": "Data obÈ›inerii (ex: 'YYYY-MM')."}
                    },
                    "required": ["name"]
                }
            },
            "projects": {
                "type": "array",
                "description": "Proiecte relevante la care a lucrat candidatul.",
                "items": {
                    "type": "object",
                    "properties": {
                        "project_name": {"type": "string"},
                        "description": {"type": "string"},
                        "technologies_used": {"type": "array", "items": {"type": "string"}},
                        "project_url": {"type": "string", "description": "URL cÄƒtre proiect, dacÄƒ este disponibil."}
                    },
                    "required": ["project_name", "description"]
                }
            },
            "overall_assessment_by_llm": {
                "type": "object",
                "description": "Evaluare sumarÄƒ generatÄƒ de modelul lingvistic mare (LLM).",
                "properties": {
                    "estimated_total_experience_years": {"type": "number", "description": "NumÄƒrul total estimat de ani de experienÈ›Äƒ profesionalÄƒ relevantÄƒ, bazat pe datele din CV."},
                    "primary_roles_suitability": {
                        "type": "array",
                        "items": {"type": "string"},
                        "description": "SugereazÄƒ 2-3 roluri principale pentru care acest candidat ar putea fi cel mai potrivit, pe baza Ã®ntregului CV."
                    },
                    "key_strengths_summary": {"type": "string", "description": "Un scurt sumar (2-3 fraze) al principalelor puncte forte ale candidatului."}
                }
            }
        };

        const tabs = document.querySelectorAll('.tab-button');
        const contentSections = document.querySelectorAll('.content-section');

        function showTab(tabId) {
            tabs.forEach(tab => {
                if (tab.dataset.tab === tabId) {
                    tab.classList.add('tab-active');
                } else {
                    tab.classList.remove('tab-active');
                }
            });
            contentSections.forEach(section => {
                if (section.id === tabId) {
                    section.classList.add('active');
                } else {
                    section.classList.remove('active');
                }
            });
             window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        tabs.forEach(tab => {
            tab.addEventListener('click', () => {
                showTab(tab.dataset.tab);
            });
        });
        
        const schemaContainer = document.getElementById('cvSchemaContainer');

        function renderSchema(schemaData, container, level = 0) {
            if (!schemaData || typeof schemaData !== 'object') {
                console.error("Invalid schemaData provided to renderSchema:", schemaData);
                return;
            }

            for (const key in schemaData) {
                if (schemaData.hasOwnProperty(key)) {
                    const item = schemaData[key];
                    const div = document.createElement('div');
                    div.className = `mb-3 p-3 rounded-md ${level === 0 ? 'bg-slate-50 shadow' : 'bg-slate-100'}`;
                    
                    const header = document.createElement('div');
                    header.className = 'flex justify-between items-start gap-x-4';

                    const titleContainer = document.createElement('div');
                    const title = document.createElement('h4');
                    title.className = `text-md font-semibold ${level === 0 ? 'text-sky-700' : 'text-sky-600'} schema-key`;
                    let titleText = key;
                    if (typeof item === 'object' && item !== null && (item.type === 'object' || item.type === 'array')) {
                        titleText += ' â–¼';
                    }
                    title.textContent = titleText;
                    titleContainer.appendChild(title);

                    if (item && item.description) {
                        const descriptionP = document.createElement('p');
                        descriptionP.className = 'text-xs text-slate-500 mt-1 italic text-right flex-shrink-0 max-w-[50%]';
                        descriptionP.textContent = item.description;
                        titleContainer.appendChild(descriptionP); 
                    }
                     header.appendChild(titleContainer);
                    
                    div.appendChild(header);

                    const detailsDiv = document.createElement('div');
                    detailsDiv.className = 'schema-details mt-2 text-sm';
                    
                    if (item && item.type) {
                         const typeP = document.createElement('p');
                         typeP.innerHTML = `<strong class="text-slate-700">Tip:</strong> <span class="bg-sky-100 text-sky-700 px-2 py-0.5 rounded-full text-xs">${item.type}</span>`;
                         detailsDiv.appendChild(typeP);
                    }
                    if (item && item.required && Array.isArray(item.required) && item.required.length > 0) {
                        const requiredP = document.createElement('p');
                        requiredP.innerHTML = `<strong class="text-slate-700">CÃ¢mpuri Obligatorii (Ã®n acest obiect):</strong> ${item.required.join(', ')}`;
                        detailsDiv.appendChild(requiredP);
                    }


                    if (item && item.type === 'object' && item.properties) {
                        renderSchema(item.properties, detailsDiv, level + 1);
                    } else if (item && item.type === 'array' && item.items) {
                        const itemsHeader = document.createElement('p');
                        itemsHeader.innerHTML = `<strong class="text-slate-700">Structura Elementelor din Array:</strong>`;
                        detailsDiv.appendChild(itemsHeader);
                        if (item.items.type === 'object' && item.items.properties) {
                            renderSchema(item.items.properties, detailsDiv, level + 1);
                        } else if (item.items.type) {
                             const itemTypeP = document.createElement('p');
                             itemTypeP.innerHTML = `<strong class="text-slate-700">Tip element:</strong> <span class="bg-sky-100 text-sky-700 px-2 py-0.5 rounded-full text-xs">${item.items.type}</span>`;
                             if (item.items.description) {
                                itemTypeP.innerHTML += `<span class="italic text-xs text-slate-500 ml-2">(${item.items.description})</span>`;
                             }
                             detailsDiv.appendChild(itemTypeP);
                        }
                    }
                    
                    div.appendChild(detailsDiv);
                    container.appendChild(div);

                    if (item && typeof item === 'object' && (item.type === 'object' || item.type === 'array')) {
                        title.addEventListener('click', (e) => {
                            e.stopPropagation(); 
                            detailsDiv.classList.toggle('open');
                            title.textContent = `${key} ${detailsDiv.classList.contains('open') ? ' â–²' : ' â–¼'}`;
                        });
                         if (level === 0) { 
                            detailsDiv.classList.add('open');
                            title.textContent = `${key} â–²`;
                         } else {
                             title.textContent = `${key} â–¼`; 
                         }
                    }
                }
            }
        }
        
        document.addEventListener('DOMContentLoaded', () => {
            if (tabs.length > 0) {
                showTab(tabs[0].dataset.tab);
            }
            if (schemaContainer) {
                renderSchema(CV_EXTRACTION_SCHEMA, schemaContainer); // Corectat aici
            }
        });


        function toggleDetails(button, elementId) {
            const detailsElement = document.getElementById(elementId);
            if (detailsElement) {
                const isOpen = detailsElement.classList.toggle('open');
                button.classList.toggle('open', isOpen);
            }
        }
        
        document.getElementById('currentYear').textContent = new Date().getFullYear();

    </script>
</body>
</html>
